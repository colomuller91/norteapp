(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c0fca"],{"43b7":function(t,e,r){"use strict";r.r(e);var a,o,s,i,n,d,c,l=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{staticClass:"mb-10",attrs:{fluid:""}},[r("v-row",{staticClass:"text-center"},[r("v-col",{attrs:{cols:"12"}},[t.orders_array.length>0?r("p",{staticClass:"display-1"},[t._v("Pedidos en curso")]):t._e()]),t.orders_array.length>0?r("v-col",{attrs:{cols:"12"}},[r("div",{staticClass:"d-flex flex-wrap justify-start"},t._l(t.orders_array,(function(e){return r("OrderItem",{attrs:{"size-config":"big",item:e},on:{orderEnded:t.loadOrders,clicked:function(e){return t.openModal(e.itemdata)}}})})),1)]):r("v-col",{attrs:{cols:"12"}},[r("br"),r("br"),r("p",{staticClass:"title"},[t._v(" ¯\\_(ツ)_/¯ "),r("br"),r("br"),t._v(" Aún no creaste ningún PEDIDO en este dispositivo ")])])],1),t.hasProducts?r("v-btn",{attrs:{color:"primary",dark:"",big:"",right:"",fixed:"",bottom:"",rounded:"",fab:""},on:{click:function(e){return t.openModal({})}}},[r("v-icon",[t._v("mdi-plus")])],1):t._e(),r("ModalPedido",{ref:"modalPedido",on:{realized:function(e){return t.operationDone(e.operation)},orderEnded:t.loadOrders}}),r("v-snackbar",{attrs:{timeout:4e3,color:"primary"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(t._s(t.textOperation))])],1)},u=[],m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-col",{attrs:{cols:t.sizes.cols,sm:t.sizes.sm,md:t.sizes.md,lg:t.sizes.lg}},[r("v-card",{staticClass:"d-flex flex-column ",staticStyle:{"box-sizing":"border-box"},attrs:{width:"100%",height:"100%",raised:""}},[r("div",{on:{click:function(e){return t.$emit("clicked",{itemdata:t.item})}}},[r("v-card-title",{staticClass:"d-block px-2 subtitle-1"},[t._v(" "+t._s(t.item.value.text)+" ")]),t.hideDescription?t._e():r("v-card-text",{staticClass:"title font-weight-bold"},[t._v(" $ "+t._s(t.totalAmount)+" ")]),t._l(t.grouped,(function(e){return r("v-card-subtitle",{staticClass:"py-0"},[t._v(" "+t._s(e.qty)+" × "+t._s(e.value.name)+" ")])})),r("br")],2),r("v-spacer"),r("v-card-actions",{staticClass:"pa-0 d-flex",attrs:{align:"bottom"}},[r("v-btn",{staticClass:"ma-0 flex-grow-1 subtitle-1",staticStyle:{"border-color":"dimgray","background-color":"#eeeeee"},attrs:{tile:"",height:"60px",outlined:"",color:"green"},on:{click:t.finalizeOrder}},[t._v(" VENDER ")]),r("v-btn",{staticClass:"ma-0 flex-grow-1 subtitle-1 border1",staticStyle:{"border-color":"dimgray","background-color":"#EEEEEE"},attrs:{tile:"",height:"60px",outlined:"",color:"red"},on:{click:t.deleteOrder}},[t._v(" CANCELAR ")])],1)],1)],1)},f=[],v=(r("4160"),r("a9e3"),r("159b"),r("98b3")),p={name:"ProductItem",props:{item:{type:Object,required:!0},cardWidth:{default:200},sizeConfig:{default:"normal"},hideDescription:{default:!1}},data:function(){return{itemSizes:{big:{cols:12,sm:6,md:4,lg:4},normal:{cols:6,sm:4,md:3,lg:3}}}},computed:{sizes:function(){return this.itemSizes[this.sizeConfig]},grouped:function(){var t={};return this.item.value.items.forEach((function(e){t[e.key]?t[e.key].qty++:t[e.key]={value:e.value,qty:1}})),t},totalAmount:function(){var t=0;return this.item.value.items.forEach((function(e){t+=Number(e.value.amount)})),t}},methods:{deleteOrder:function(){var t=this,e=this.item.key;a.removeItem(e).then((function(){return t.$emit("orderEnded")}))},finalizeOrder:function(){var t=this,e=this.item;e.value.done=!0,o.addItem({date:new Date,items:e.value.items}),a.updateItem(e.value,e.key).then((function(){return t.$emit("orderEnded")}))}},mounted:function(){a=new v["a"]("pedidos"),o=new v["a"]("ventas")}},h=p,b=r("2877"),g=Object(b["a"])(h,m,f,!1,null,null,null),_=g.exports,x=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("v-card",{attrs:{tile:"",onresize:"resize"}},[r("v-toolbar",{ref:"toolbar",attrs:{flat:"",dark:"",color:"primary"}},[r("v-btn",{attrs:{icon:"",dark:""},on:{click:t.closeModalPedido}},[r("v-icon",[t._v("mdi-close")])],1),r("v-toolbar-title",[t._v("Datos del pedido")]),r("v-spacer"),t.orderId>0&&t.$store.getters.totalOrderAmount>0?r("v-toolbar-items",[r("v-btn",{attrs:{dark:"",color:"blue"},on:{click:t.finalizeOrder}},[t._v(" VENDER ")])],1):t._e(),t.products_array.length>0&&t.$store.getters.totalOrderAmount>0?r("v-toolbar-items",[r("v-btn",{attrs:{dark:"",text:""},on:{click:t.saveOrder}},[t._v(" Guardar ")])],1):t._e()],1),r("v-container",{staticClass:"pb-0",attrs:{fluid:""}},[r("v-row",{ref:"rowComentario",attrs:{"no-gutters":""}},[r("v-col",{attrs:{cols:"12",sm:"6"}},[r("v-textarea",{staticClass:"pa-4",attrs:{"no-resize":"","prepend-inner-icon":"mdi-comment",value:t.$store.state.pedido.text,label:"Comentario",rows:"2"},on:{blur:function(e){return t.$store.dispatch("setTextPedido",e.target.value)}}})],1)],1),r("v-row",{ref:"orderSelection",attrs:{"no-gutters":""}},["xs"==t.$vuetify.breakpoint.name?r("v-col",{attrs:{cols:"12"}},[r("v-tabs",{attrs:{centered:"","fixed-tabs":""},model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[r("v-tab",[t._v("PRODUCTOS")]),r("v-tab",[t._v("ESTE PEDIDO: $"+t._s(t.$store.getters.totalOrderAmount))])],1),r("v-tabs-items",{model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[r("v-tab-item",[r("div",{staticClass:"d-flex flex-wrap justify-start"},t._l(t.products_array,(function(e){return r("ProductItem",{attrs:{item:e},on:{clicked:function(e){return t.$store.dispatch("addItem",{entidad:"pedido",item:e.itemdata})}}})})),1)]),r("v-tab-item",[r("div",t._l(t.$store.getters.pedidoAgrupado,(function(e,a){return r("v-card",{staticClass:"ma-3",attrs:{raised:""},on:{click:function(e){return t.$store.dispatch("removeItem",{entidad:"pedido",itemId:a})}}},[r("v-card-text",[r("p",{staticClass:"title text--primary mb-0 d-flex"},[r("span",{staticClass:"pr-5"},[t._v(t._s(e.qty)+" x")]),r("span",{staticClass:"grow text-left"},[t._v(t._s(e.value.name))]),r("span",[t._v("$ "+t._s(e.value.amount*e.qty))])])])],1)})),1)])],1)],1):r("v-col",{staticClass:"pa-0",attrs:{cols:"12"}},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{staticClass:"py-4",style:"overflow-y: auto; max-height:"+t.customHeight,attrs:{cols:"7",md:"8"}},[r("p",{staticClass:"text-center"},[t._v("PRODUCTOS")]),r("div",{staticClass:"d-flex flex-wrap justify-start overflow-y-auto"},t._l(t.products_array,(function(e){return r("ProductItem",{attrs:{item:e,"size-config":"big"},on:{clicked:function(e){return t.$store.dispatch("addItem",{entidad:"pedido",item:e.itemdata})}}})})),1)]),r("v-col",{staticClass:"py-4",style:"border-left: 2px solid #c3c3c3; overflow-y: auto; max-height:"+t.customHeight,attrs:{cols:"5",md:"4"}},[r("p",{staticClass:"text-center"},[t._v("ESTE PEDIDO: $"+t._s(t.$store.getters.totalOrderAmount))]),r("div",{staticClass:"overflow-y-auto"},t._l(t.$store.getters.pedidoAgrupado,(function(e,a){return r("v-card",{staticClass:"ma-3",attrs:{raised:""},on:{click:function(e){return t.$store.dispatch("removeItem",{entidad:"pedido",itemId:a})}}},[r("v-card-text",[r("p",{staticClass:"title text--primary mb-0 d-flex"},[r("span",{staticClass:"pr-5"},[t._v(t._s(e.qty)+" x")]),r("span",{staticClass:"grow text-left"},[t._v(t._s(e.value.name))]),r("span",[t._v("$ "+t._s(e.value.amount*e.qty))])])])],1)})),1)])],1)],1)],1)],1)],1)],1)},y=[],k=(r("96cf"),r("1da1")),w=r("5530"),C=r("9588"),$={name:"ModalPedido",components:{ProductItem:C["a"]},data:function(){return{products_array:[],orderId:0,dialog:!1,tabs:null,windowSize:null,customHeight:"0px"}},mounted:function(){var t=this;s=new v["a"]("productos"),s._loaded.then((function(){s.getAllItems().then((function(e){t.products_array=e}))})),i=new v["a"]("pedidos"),n=new v["a"]("ventas")},methods:{open:function(t){var e=Object(w["a"])({},t);this.dialog=!0,e.key?(this.tabs=1,this.orderId=e.key,this.$store.dispatch("setPedido",Object(w["a"])({key:e.key},e.value))):(this.tabs=0,this.orderId=e.key,this.$store.dispatch("clearPedido"))},resize:function(){var t=this;this.$nextTick(Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.rowComentario;case 2:t.customHeight=window.innerHeight-(t.$refs.rowComentario.offsetTop+t.$refs.rowComentario.offsetHeight)+"px";case 3:case"end":return e.stop()}}),e)}))))},saveOrder:function(){var t,e=this;t=this.orderId>0?i.updateItem(Object(w["a"])({done:0},this.$store.state.pedido),this.orderId):i.addItem(Object(w["a"])({date:new Date,done:0},this.$store.state.pedido)),t.then((function(){e.$emit("realized",{operation:0===e.orderId?"Creación":"Modificación"}),e.dialog=!1}))},finalizeOrder:function(){var t=this,e=this.$store.state.pedido;e.done=1,n.addItem({date:new Date,items:e.items}),i.updateItem(e,e.key).then((function(){t.$emit("orderEnded"),t.dialog=!1}))},closeModalPedido:function(){this.dialog=!1,this.$store.dispatch("clearPedido")}},watch:{dialog:function(t){t&&this.resize()}},computed:{offsetTop:function(){return this.$refs.rowComentario?window.innerHeight-(this.$refs.rowComentario.offsetTop+this.$refs.rowComentario.offsetHeight)+"px":""}}},O=$,I=Object(b["a"])(O,x,y,!1,null,null,null),E=I.exports,z={name:"Pedidos",components:{ModalPedido:E,OrderItem:_},data:function(){return{orders_array:[],productDetailsModal:!1,snackbar:!1,snackbarText:"",hasProducts:!1}},mounted:function(){var t=this;c=new v["a"]("productos"),c._loaded.then((function(){return c.countItems().then((function(e){return t.hasProducts=e>0}))})),d=new v["a"]("pedidos"),this.loadOrders()},methods:{openModal:function(t){this.$refs.modalPedido.open(Object.assign(t))},operationDone:function(t){this.snackbarText=t,this.snackbar=!0,this.loadOrders()},loadOrders:function(){var t=this;d._loaded.then((function(){d.getFilteredItems("done",{filter:"only",value:0}).then((function(e){console.log(e),t.orders_array=e}))}))}},computed:{textOperation:function(){return"".concat(this.snackbarText," realizada!")}}},P=z,D=Object(b["a"])(P,l,u,!1,null,null,null);e["default"]=D.exports}}]);
//# sourceMappingURL=chunk-2d0c0fca.c7ace85a.js.map